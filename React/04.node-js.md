# Node.js

## Node.js란 무엇인가?

React를 알고자 하는데 왜 Node를 알아야할까,
-> React는 Node.js를 기반으로 동작하는 기술이기 때문에 그렇다.
Next.js, Vue.js, svelte까지 모두 node를 기본으로 동작한다.

### Node.js는 자바스크립트 런타임, 즉 자바스크립트의 실행환경이다.

즉, 웹 브라우저가 아닌 환경에서도 자바스크립트 코드를 실행시켜주는, 자바스크립트의 실행환경이다. 실행환경 = 구동기라는 의미와 같다.
(닌텐도 게임기에 게임팩을 넣어서 게임을 하는 것과 같은 매커니즘)

언어를 구동하는 구동기를 실행환경, 런타임이라고 한다.
그래서 Node.js는 자바스크립트 엔진으로 빌드, 즉 만들어진 자바스크립트의 런타임이다.

## Node.js가 필요한 이유는 뭘까?

자바스크립트의 태생은 웹 페이지 안에서 일어나는 아주 단순한 기능만을 개발하기 위해 만들어진 스크립트언어였다. 예를 들면 웹에서 버튼을 클릭하면 경고창을 띄워준다거나, 요소의 색상을 변경시킨다던가 하는 아주 간단한 목적으로 오직 웹 브라우저 내에서만 동작할 수 있도록 개발이 되었다. 그렇기 때문에 동시대에 존재했던 C언어나 자바와 다르게 그 언어가 자체로 매우 유연하고 작성하기 편리하도록 설계되었다. 그렇게 언어가 생산성, 빠르게 개발하는데 중심을 가지고 발전해 온 언어이다. 시간이 지나면서 자바스크립트 문법 체계, 설계 철학에 많은 관심을 가지게 되면서
웹 브라우저가 아닌 외부에서도 자바스크립트를 이용해서 프로그램이 만들고 싶어졌다!

여기서 Node.js가 등장한다. Node.js는 javascript가 가진 태생적인 한계를 넘어설 수 있게 해주었고, 그 결과 이제는 Node.js를 이용해서 많은 것들을 만들어 낼 수 있게 되었다.

즉,

- 자바스크립트를 브라우저 외부에서도 실행할 수 있게 해주는 런타임 환경
- React 또한 Node.js를 기반으로 동작하는 기술이다.

## NPM (Node Package Manager)

- Node.js의 프로젝트 단위인 패키지를 관리하는 도구
- 새로운 패키지를 생성한다거나, 외부 라이브러리를 실행하거나 삭제하는 유용한 기능들을 제공한다.

## Node.js 사용하기

프로그래밍에서는 어떤 목적을 갖는 프로그램을 만들때 프로젝트라는 단위를 사용한다.
쇼핑몰 사이트를 만든다고 하면, 쇼핑몰 프로젝트라고 한다. Node.js에서는 이 '프로젝트' 단위를 'package' 라고 부른다.

Node.js 환경에서는 여러개의 javasciprt 파일로 어떠한 목적을 갖는 프로그램을 만들때 모두 다 이 package라는 단위로 프로그램을 만들게 된다. 앞으로 만들 javascirpt 앱, 모든 React 앱들도 모두 Package 라는 단위로 만들어져 있다. 그래서 무언가를 만들려고 할때, 이 패키지를 잘 사용할 수 있어야 한다.

### Node 패키지 생성하기

가장 먼저 해줘야할 것은, 패키지의 루트폴더를 만드는 것이다.
패키지를 생성할때는 terminal을 이용한다. 이때 사용하는 명령이 npm init
생성을 마치면 package.json 이라고 하는 설정 파일이 자동으로 생성된다.
여기에는 패키지에 대한 정보가 담겨있다. 노드를 이용하면 node 옆에 파일명으로 해당 파일을 실행할 수 있다. 그런데 이러한 방식으로 프로그램을 실행하다보면, 복잡해지니까
프로젝트 실행 명령어를 package.json 에 하나의 스크립트로 작성하여 관리한다.
일종의 매크로 인 것이다. 그래서 npm run start 의 명령어로 프로젝트를 실행할 수 있었던 것이다.

## Node의 모듈 시스템

각각의 기능을 하나의 파일에 작업하지 않고, 기능별로 분리한 각각의 파일들을 '모듈'이라고 한다.
User 모듈, payment 모듈 등..
이러한 모듈들을 새롭게 생성하고 불러오고 사용하는 등의 모듈을 다루는 시스템을 모듈 시스템 이라고 한다.
많은 모듈 시스템이 있는데, 가장 많이 사용하는 것은 CommonJS와 ESMoudle이다.

### CommonJS 모듈

exports라는 프로퍼티로 내보내고 싶은 값들을 넣어준다.

```
module.exports = {
    add, sub
}
```

이렇게 내보내게 되면 commonJS 모듈 시스템에 의해서 외부로 내보내지게 된다. 이렇게 내보내진 함수는

```
require('math.js') // 또는
const {add, sub} = require('math.js')
```

이런식으로 불러와서 사용할 수 있다. 이렇게 선언하면 math 모듈로부터 내보내진 값을 모두 반환해준다(사용할 수 있게 된다.)

### React에서도 동작하는 ESModule

CommonJS보다 최신식 모듈이다. 이 모듈을 사용하기 위해서는 package.json 파일에 내가 ES 모듈 시스템을 사용하겠다.는 명시를 해줘야한다.

```
"type" : "module"
```

이렇게 명시하게 되면 기존에 사용하던 CommonJS 모듈이 있을 경우 오류가 발생한다.
ESModule과 CommonJS 모듈은 기본적으로 함께 사용할 수 없기 때문이다.
함수를 내보내려면, 함수에 export 키워드를 사용하면 된다.

```
export function add(){
    ...
}

export function sub() {
    ....
}
// 그리고 이 모듈을 외부에서 사용하려면
import {add, sub} from 'math.js'
```

ES 모듈을 사용하려면 import 할때 파일의 확장자까지 꼭 작성해줘야한다.
혹은 각각의 함수에 export 키워드를 붙이지 않고, 한번에 붙여줄 수도 있다.

```
function add(){

}

function sub(){

}
export {add, sub}
```

- 하나의 모듈을 대표하는 디폴트 값을 내보내는 방법도 있다.

```
export default multi(){}
```

이 모듈은 math 모듈을 대표하는 단 하나의 모듈이 된다.불러올 때는 multi from './math.js' 이런 식으로 중괄호 없이 불러와야한다. 특별히 이런 디폴트 함수는 이름을 맘대로 정해서 불러올 수도 있다.

```
import multi from './math.js'
import mul from './math.js'
// 이렇게 디폴트 함수 한정 별칭으로 불러올 수 있다는 의미
// 디폴트 함수가 아닌 애들은 {sub : substrack} 이런식으로 불러올 수 있음.
```

## Node.js 의 dependency

package.json에 명시된 dependency 안의 목록들은, 이 프로젝트는 아래와 같은 dependency에 의존성을 가지고 있음을 명시한 것이다. 즉, 이 라이브러리가 있어야 동작할 수 있어. 와 같은 의미를 갖는 것이다.

- devDependency 는 개발 환경에서 사용되는 depencency들을 설명해둔 것임
- package.json은 "^6.0.2" 즉, 대략 6 버전대 임을 명시하고, 정확한 버전의 정보는
  package-lock.json에서 확인할 수 있다. (^가 대략 ~다. 를 의미한다.)
  => 6점대 버전중에 최신 버전을 설치하겠다. 이런 의미를 가짐

- 그래서 node_modules는 배포할 때 포함하지 않아도 된다. package-lock, package.json에 패키지 버전의 정보가 명시되어있기 때문. node_modules의 용량은 되게 큼.
